<ons-page ng-controller="ConversationsController as vm">
    <ons-toolbar>
        <div class="left">
            <!--Add Ng-click even to nagivate back to coversations-->
            <ons-toolbar-button ng-click="vm.newConversation()" modifier="outline">
                <ons-icon icon="ion-compose" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
            </ons-toolbar-button>
        </div>
        <div class="center">
            Conversations
        </div>
        <!--TODO implement searching-->
        <!--<div class="right">
            <ons-toolbar-button>
                <ons-icon icon="ion-ios-search-strong" fixed-width="false" style="font-size: 26px; vertical-align: -4px;"></ons-icon>
            </ons-toolbar-button>
        </div>-->
    </ons-toolbar>
    <ons-list>
        <ons-list-item style="margin-top:10px">
            <input type="search" value="" placeholder="Search" class="search-input" ng-model="vm.searchConversationString">
        </ons-list-item>
    </ons-list>
    <!--Add Ng-show to the div tag below even to display or hide the message depending on the whether there are conversations-->
    <div ng-show="vm.emptyConversations" class="center" style="text-align: center">
        <p class="msg-app-conversations-empty">No conversations!</p>
    </div>
    <!--Add Ng-show to the div tag below even to display or hide the message depending on the whether there are conversations-->
    <ons-list ng-show="!vm.emptyConversations" class="timeline" modifier="inset" >
        <!-- Use ng-repeat in the tag before to iterate and display ng-repeat="conversation in vm.conversations"
             Add an ng-click to take action upon tapping on the list item, i.e navigating to conv.-->
        <!-- TODO | orderBy:(lastMessage.messageDate|date: 'MMM d, y h:mm a'):true-->
        <!-- Filters the conversations by the search term applied to the name of the other user. -->
        <ons-list-item ng-repeat="conversation in vm.conversations | filter: {user_1:vm.searchConversationString}"
                       ng-click="vm.goToConversation(conversation)"
                       class="timeline-li" modifier="tappable"  >
            <ons-row>
                <ons-col width="50px">
                    <img ng-src="{{conversation.imageUrl}}" class="timeline-image">
                </ons-col>

                <ons-col>
                    <div class="timeline-date">{{conversation.lastMessage.messageDate|date: 'MMM d, y h:mm a'}}</div>
                    <div class="timeline-from">
                        <span class="timeline-name">{{conversation.user_1}}</span>
                    </div>

                    <div class="timeline-message">
                       <!--Display the lastMessage content via an <p> html tag-->
                        <p>{{conversation.lastMessage.messageContent}}</p>
                    </div>
                </ons-col>
            </ons-row>
        </ons-list-item>
    </ons-list>
</ons-page>