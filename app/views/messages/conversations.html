<ons-page ng-controller="ConversationsController as vm">
    <ons-toolbar>
        <div class="left">
            <ons-toolbar-button modifier="outline" ng-click="navi.pushPage('./views/messages/new-conversation.html')">
                <ons-icon icon="ion-compose" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
            </ons-toolbar-button>
        </div>
        <div class="center">
            Conversations
        </div>
        <div class="right">
            <ons-toolbar-button ng-click="vm.toggle()">
                <ons-icon icon="ion-ios-search-strong" fixed-width="false" style="font-size: 26px; vertical-align: -4px;"></ons-icon>
            </ons-toolbar-button>
        </div>
    </ons-toolbar>
    <div ng-if="vm.toggleSearchbar">
        <p style="padding: 10px">
            <input type="search" class="search-input" placeholder="Search" ng-model="vm.searchContent">
        </p>
        <ons-list class="timeline" modifier="inset" ng-repeat="conversation in vm.filteredConv()">
            <ons-list-item class="timeline-li" modifier="tappable" ng-click="navi.pushPage('./views/messages/individual-conversation.html',{'conversation':conversation})" >
                <ons-row >
                    <ons-col width="50px">
                        <img ng-src="{{conversation.imageUrl}}" class="timeline-image">
                    </ons-col>

                    <ons-col>
                        <div class="timeline-date">{{conversation.lastMessage.messageDate|date: 'MMM d, y h:mm:ss a'}}</div>
                        <div class="timeline-from">
                            <span class="timeline-name">{{conversation.user_1}}</span>
                        </div>

                        <div class="timeline-message">
                            <p>{{conversation.lastMessage.messageContent}}</p>
                        </div>
                    </ons-col>
                </ons-row>
            </ons-list-item>
        </ons-list>
    </div>
    <div ng-if="!vm.toggleSearchbar">
        <div class="center" style="text-align: center" ng-if="vm.emptyConversations">
            <p class="msg-app-conversations-empty">No conversations!</p>
        </div>
        <ons-list class="timeline" modifier="inset" ng-if="!vm.emptyConversations" ng-repeat="conversation in vm.conversations">
            <ons-list-item class="timeline-li" modifier="tappable" ng-click="navi.pushPage('./views/messages/individual-conversation.html',{'conversation':conversation})" >
                <ons-row >
                    <ons-col width="50px">
                        <img ng-src="{{conversation.imageUrl}}" class="timeline-image">
                    </ons-col>

                    <ons-col>
                        <div class="timeline-date">{{conversation.lastMessage.messageDate|date: 'MMM d, y h:mm:ss a'}}</div>
                        <div class="timeline-from">
                            <span class="timeline-name">{{conversation.user_1}}</span>
                        </div>

                        <div class="timeline-message">
                            <p>{{conversation.lastMessage.messageContent}}</p>
                        </div>
                    </ons-col>
                </ons-row>
            </ons-list-item>
        </ons-list>
    </div>

</ons-page>